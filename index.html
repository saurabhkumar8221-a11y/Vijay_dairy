<!DOCTYPE html>
<html>
<head>
  <title>SIM Management Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body style="font-family: Arial; padding:20px;">

<h2>SIM Management Panel</h2>

<!-- SELECT ACTION -->
<select id="mainSelect" onchange="showForm()">
  <option value="">Select Option</option>
  <option value="addUser">Add Retailer / Agent</option>
  <option value="addStock">Add Distributor Stock</option>
  <option value="giveSim">Give SIM</option>
</select>

<hr>

<!-- ADD USER -->
<div id="addUserForm" style="display:none;">
  <h3>Add Retailer / Agent</h3>

  <input placeholder="Retailer / Agent" id="userType"><br><br>
  <input placeholder="LAPU Number" id="lapu"><br><br>
  <input placeholder="Contact" id="contact"><br><br>
  <input placeholder="Shop Name" id="shopName"><br><br>
  <input placeholder="Owner Name" id="owner"><br><br>
  <input placeholder="Area" id="area"><br><br>

  <select id="zone">
    <option value="">Select Zone</option>
    <option value="Patory">Patory</option>
    <option value="Sarairanjan">Sarairanjan</option>
  </select><br><br>

  <button onclick="submitUser()">Submit</button>
</div>

<!-- ADD STOCK -->
<div id="addStockForm" style="display:none;">
  <h3>Add Distributor Stock</h3>

  <input type="number" placeholder="Total SIM Added" id="totalSim"><br><br>

  <button onclick="submitStock()">Add Stock</button>
</div>

<!-- GIVE SIM -->
<div id="giveSimForm" style="display:none;">
  <h3>Give SIM</h3>

  <input placeholder="LAPU Number" id="giveLapu"><br><br>
  <input type="number" placeholder="SIM Quantity" id="simQty"><br><br>

  <button onclick="submitGiveSim()">Give SIM</button>
</div>

<script>

const scriptURL = "https://script.google.com/macros/s/AKfycbw0fZpOCTHHUicuNllpPNX6IuyfJ-cU3LCR0VsP1e1Rj9w2YnsCXc2ga1KTXs0IyC71Fg/exec";

function showForm() {
  document.getElementById("addUserForm").style.display = "none";
  document.getElementById("addStockForm").style.display = "none";
  document.getElementById("giveSimForm").style.display = "none";

  let val = document.getElementById("mainSelect").value;
  if(val) {
    document.getElementById(val + "Form").style.display = "block";
  }
}

// ADD USER
function submitUser() {

  const data = {
    action: "addUser",
    userType: document.getElementById("userType").value,
    lapu: document.getElementById("lapu").value,
    contact: document.getElementById("contact").value,
    shopName: document.getElementById("shopName").value,
    owner: document.getElementById("owner").value,
    latitude: "",
    longitude: "",
    address: "",
    area: document.getElementById("area").value,
    zone: document.getElementById("zone").value
  };

  fetch(scriptURL, {
    method: "POST",
    body: JSON.stringify(data)
  })
  .then(res => res.text())
  .then(() => {
    alert("User Added Successfully");
    document.getElementById("addUserForm").reset?.();
    location.reload();
  });
}

// ADD STOCK
function submitStock() {

  const data = {
    action: "addStock",
    totalSim: document.getElementById("totalSim").value
  };

  fetch(scriptURL, {
    method: "POST",
    body: JSON.stringify(data)
  })
  .then(res => res.text())
  .then(() => {
    alert("Stock Added Successfully");
    location.reload();
  });
}

// GIVE SIM
function submitGiveSim() {

  const data = {
    action: "giveSim",
    lapu: document.getElementById("giveLapu").value,
    simGiven: document.getElementById("simQty").value
  };

  fetch(scriptURL, {
    method: "POST",
    body: JSON.stringify(data)
  })
  .then(res => res.text())
  .then(() => {
    alert("SIM Given Successfully");
    location.reload();
  });
}

</script>

</body>
</html>
