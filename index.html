<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Agent Activation Panel</title>

<style>
body{
  font-family: Arial;
  background:#f4f6f9;
  padding:30px;
}

.container{
  background:white;
  padding:25px;
  max-width:400px;
  margin:auto;
  border-radius:8px;
  box-shadow:0 0 10px rgba(0,0,0,0.1);
}

h2{
  text-align:center;
}

input, select{
  width:100%;
  padding:10px;
  margin:8px 0;
  border:1px solid #ccc;
  border-radius:5px;
}

button{
  width:100%;
  padding:12px;
  background:#28a745;
  color:white;
  border:none;
  border-radius:5px;
  font-size:16px;
  cursor:pointer;
}

button:hover{
  background:#218838;
}

.success{
  color:green;
  text-align:center;
  margin-top:10px;
}

.error{
  color:red;
  text-align:center;
  margin-top:10px;
}
</style>
</head>

<body>

<div class="container">

<h2>Agent Activation Entry</h2>

<form id="activationForm">

<input type="text" id="agentCode" placeholder="Agent Code" required>

<input type="tel"
       id="customerMobile"
       placeholder="Customer Mobile (10 Digit)"
       maxlength="10"
       required
       oninput="this.value=this.value.replace(/[^0-9]/g,'')">

<select id="operator" required>
<option value="">Select Operator</option>
<option value="JIO">JIO</option>
<option value="VI">VI</option>
<option value="BSNL">BSNL</option>
</select>

<select id="requestType" required>
<option value="">Select Request Type</option>
<option value="Recharge">Recharge</option>
<option value="MNP Recharge">MNP Recharge</option>
<option value="New Activation">New Activation</option>
<option value="Replacement">Replacement</option>
</select>

<input type="number" id="amount" placeholder="Amount (Optional)">

<label>Upload Image (Optional)</label>
<input type="file" id="imageFile" accept="image/*">

<button type="button" onclick="submitActivation()">Submit</button>

</form>

<div id="message"></div>

</div>

<script>

// üî¥ YAHAN APNA WEB APP URL PASTE KARO
const scriptURL = "https://script.google.com/macros/s/AKfycbxx12HuKYXsryDYSmbWBs-kcCFxknfGhthaHT3ASabcVhRFiqJjdHyLvGRMN_yG_gFIpQ/exec";

function submitActivation(){

let agentCode = document.getElementById("agentCode").value.trim();
let mobile = document.getElementById("customerMobile").value.trim();
let operator = document.getElementById("operator").value;
let requestType = document.getElementById("requestType").value;
let amount = document.getElementById("amount").value;
let fileInput = document.getElementById("imageFile");
let file = fileInput.files[0];

let messageDiv = document.getElementById("message");
messageDiv.innerHTML = "";

if(!/^[0-9]{10}$/.test(mobile)){
  messageDiv.innerHTML = "<div class='error'>Mobile must be 10 digits</div>";
  return;
}

if(file){

  let reader = new FileReader();

  reader.onload = function(){
    sendData(reader.result);
  };

  reader.readAsDataURL(file);

}else{

  sendData("");

}

function sendData(imageData){

fetch(scriptURL,{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
type:"activation",
agentCode:agentCode,
customerMobile:mobile,
operator:operator,
requestType:requestType,
amount:amount,
imageUrl:imageData
})
})
.then(response => response.json())
.then(data => {

if(data.result === "success"){
  messageDiv.innerHTML = "<div class='success'>‚úÖ Activation Saved Successfully</div>";
  document.getElementById("activationForm").reset();
}else{
  messageDiv.innerHTML = "<div class='error'>‚ùå Error Saving Data</div>";
}

})
.catch(error=>{
messageDiv.innerHTML = "<div class='error'>‚ùå Connection Error</div>";
});

}

}

</script>

</body>
</html>
