<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Distributor Management Panel</title>

<style>
body{margin:0;font-family:Arial;background:#f4f6f9;}
.header{background:#d10000;color:white;padding:18px;text-align:center;font-weight:bold;font-size:18px;}
.container{max-width:480px;margin:20px auto;background:white;padding:20px;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,0.1);}
.toggle{display:flex;gap:8px;margin-bottom:15px;}
.toggle button{flex:1;padding:10px;border:none;border-radius:8px;background:#eee;font-weight:bold;}
.toggle button.active{background:#d10000;color:white;}
input,select{width:100%;padding:10px;margin-bottom:12px;border-radius:8px;border:1px solid #ccc;}
button.submit{background:#d10000;color:white;font-weight:bold;}
.success{text-align:center;color:green;}
.hidden{display:none;}
</style>
</head>

<body>

<div class="header">
VIJAY DAIRY DISTRIBUTOR PANEL
</div>

<div class="container">

<div class="toggle">
<button onclick="showSection('user')" id="btnUser" class="active">Add Agent/Retailer</button>
<button onclick="showSection('stock')" id="btnStock">Add Stock</button>
<button onclick="showSection('give')" id="btnGive">Give SIM</button>
</div>

<!-- ================= USER SECTION ================= -->
<div id="userSection">

<select id="userType">
<option value="Agent">Agent</option>
<option value="Retailer">Retailer</option>
</select>

<input type="number" id="lapu" placeholder="LAPU Number">
<input type="text" id="contact" placeholder="Contact No">
<input type="text" id="shop" placeholder="Shop Name">
<input type="text" id="owner" placeholder="Owner Name">
<input type="text" id="zone" placeholder="Zone">

<button class="submit" onclick="saveUser()">SAVE USER</button>

</div>

<!-- ================= STOCK SECTION ================= -->
<div id="stockSection" class="hidden">

<input type="number" id="stockQty" placeholder="Enter Quantity">
<button class="submit" onclick="addStock()">ADD STOCK</button>

</div>

<!-- ================= GIVE SECTION ================= -->
<div id="giveSection" class="hidden">

<select id="lapuDropdown">
<option>Loading LAPU...</option>
</select>

<input type="number" id="giveQty" placeholder="Enter Quantity">
<button class="submit" onclick="giveSim()">GIVE SIM</button>

</div>

<div class="success" id="msg"></div>

</div>

<script>

const scriptURL="https://script.google.com/macros/s/AKfycbw0fZpOCTHHUicuNllpPNX6IuyfJ-cU3LCR0VsP1e1Rj9w2YnsCXc2ga1KTXs0IyC71Fg/exec";

// ===== SECTION SWITCH =====
function showSection(section){

document.getElementById("userSection").classList.add("hidden");
document.getElementById("stockSection").classList.add("hidden");
document.getElementById("giveSection").classList.add("hidden");

document.getElementById("btnUser").classList.remove("active");
document.getElementById("btnStock").classList.remove("active");
document.getElementById("btnGive").classList.remove("active");

if(section=="user"){
document.getElementById("userSection").classList.remove("hidden");
document.getElementById("btnUser").classList.add("active");
}
if(section=="stock"){
document.getElementById("stockSection").classList.remove("hidden");
document.getElementById("btnStock").classList.add("active");
}
if(section=="give"){
document.getElementById("giveSection").classList.remove("hidden");
document.getElementById("btnGive").classList.add("active");
}

}

// ===== SAVE USER =====
function saveUser(){

fetch(scriptURL,{
method:"POST",
body:JSON.stringify({
type:"user",
userType:document.getElementById("userType").value,
lapu:document.getElementById("lapu").value,
contact:document.getElementById("contact").value,
shop:document.getElementById("shop").value,
owner:document.getElementById("owner").value,
zone:document.getElementById("zone").value
})
})
.then(res=>res.json())
.then(()=>{
document.getElementById("msg").innerHTML="✅ User Saved";
});
}

// ===== ADD STOCK =====
function addStock(){

fetch(scriptURL,{
method:"POST",
body:JSON.stringify({
type:"addStock",
quantity:document.getElementById("stockQty").value
})
})
.then(res=>res.json())
.then(()=>{
document.getElementById("msg").innerHTML="✅ Stock Added";
});
}

// ===== GIVE SIM =====
function giveSim(){

fetch(scriptURL,{
method:"POST",
body:JSON.stringify({
type:"giveSim",
lapu:document.getElementById("lapuDropdown").value,
quantity:document.getElementById("giveQty").value
})
})
.then(res=>res.json())
.then(()=>{
document.getElementById("msg").innerHTML="✅ SIM Given";
});
}

// ===== LOAD LAPU LIST =====
function loadLapu(){
fetch(scriptURL+"?action=getUsers")
.then(res=>res.json())
.then(data=>{
let dropdown=document.getElementById("lapuDropdown");
dropdown.innerHTML="<option value=''>Select LAPU</option>";
data.forEach(l=>{
dropdown.innerHTML+=`<option value="${l}">${l}</option>`;
});
});
}
loadLapu();

</script>

</body>
</html>
