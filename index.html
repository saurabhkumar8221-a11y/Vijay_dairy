<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body { font-family: Arial; margin: 0; }
    .tabs { display: flex; background: #222; }
    .tab {
      padding: 14px 20px;
      color: white;
      cursor: pointer;
    }
    .tab:hover { background: #444; }
    .content { display: none; padding: 20px; }
    input, select {
      padding: 8px;
      margin: 5px 0;
      width: 100%;
    }
    button {
      padding: 10px;
      background: green;
      color: white;
      border: none;
      cursor: pointer;
    }
  </style>

  <script>
    function showTab(id) {
      document.querySelectorAll('.content').forEach(div => div.style.display = 'none');
      document.getElementById(id).style.display = 'block';
    }

    window.onload = function() {
      showTab('distributor');
    };

    /* Distributor */
    function addStock() {
      const data = {
        operator: document.getElementById("d_operator").value,
        quantity: Number(document.getElementById("d_quantity").value)
      };

      google.script.run.addDistributorStock(data);
      alert("Distributor Stock Added!");
    }

    /* Transfer */
    function transferStock() {
      const data = {
        retailer: document.getElementById("t_retailer").value,
        operator: document.getElementById("t_operator").value,
        quantity: Number(document.getElementById("t_quantity").value)
      };

      google.script.run
        .withFailureHandler(err => alert(err.message))
        .transferStock(data);

      alert("Stock Transferred!");
    }

    /* Activation */
    function submitActivation() {
      const data = {
        agentCode: document.getElementById("a_agent").value,
        mobile: document.getElementById("a_mobile").value,
        operator: document.getElementById("a_operator").value,
        requestType: document.getElementById("a_type").value,
        amount: document.getElementById("a_amount").value
      };

      google.script.run.saveActivation(data);
      alert("Activation Saved!");
    }
  </script>
</head>

<body>

<div class="tabs">
  <div class="tab" onclick="showTab('distributor')">Distributor Stock</div>
  <div class="tab" onclick="showTab('transfer')">Retailer Transfer</div>
  <div class="tab" onclick="showTab('activation')">Agent Activation</div>
</div>

<!-- DISTRIBUTOR -->
<div id="distributor" class="content">
  <h2>Distributor Stock Add</h2>
  <label>Operator</label>
  <input type="text" id="d_operator">
  <label>Quantity</label>
  <input type="number" id="d_quantity">
  <button onclick="addStock()">Add Stock</button>
</div>

<!-- TRANSFER -->
<div id="transfer" class="content">
  <h2>Retailer Transfer</h2>
  <label>Retailer Code</label>
  <input type="text" id="t_retailer">
  <label>Operator</label>
  <input type="text" id="t_operator">
  <label>Quantity</label>
  <input type="number" id="t_quantity">
  <button onclick="transferStock()">Transfer</button>
</div>

<!-- ACTIVATION -->
<div id="activation" class="content">
  <h2>Agent Activation Entry</h2>
  <label>Agent Code</label>
  <input type="text" id="a_agent">
  <label>Customer Mobile</label>
  <input type="text" id="a_mobile">
  <label>Operator</label>
  <input type="text" id="a_operator">
  <label>Request Type</label>
  <input type="text" id="a_type">
  <label>Amount</label>
  <input type="number" id="a_amount">
  <button onclick="submitActivation()">Submit</button>
</div>

</body>
</html>
