<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body { font-family: Arial; margin: 0; background:#f4f6f9; }

    .navbar { display:flex; background:#007bff; }
    .navbar button {
      flex:1; padding:15px; border:none;
      background:#007bff; color:white;
      cursor:pointer; font-size:14px;
    }
    .navbar button:hover { background:#0056b3; }

    .tab { display:none; padding:20px; }
    .active { display:block; }

    input, select {
      width:100%; padding:8px; margin:6px 0;
    }

    button.submit {
      background:green; color:white;
      padding:10px; border:none;
      width:100%; cursor:pointer;
    }

    h2 { margin-top:0; }
    .result { margin-top:10px; font-weight:bold; }

  </style>
</head>
<body>

<div class="navbar">
  <button onclick="openTab('stock')">üì¶ Distributor Stock</button>
  <button onclick="openTab('transfer')">üîÅ SIM Transfer</button>
  <button onclick="openTab('activation')">üë§ Agent Activation</button>
</div>

<!-- Distributor Stock -->
<div id="stock" class="tab active">
  <h2>Add Distributor Stock</h2>
  <input type="number" id="distQty" placeholder="Enter Quantity">
  <button class="submit" onclick="addDistributorStock()">Add Stock</button>
  <div id="stockResult" class="result"></div>
</div>

<!-- SIM Transfer -->
<div id="transfer" class="tab">
  <h2>Transfer SIM to Agent</h2>
  <input type="text" id="transferLapu" placeholder="Agent Code">
  <input type="number" id="transferQty" placeholder="Quantity">
  <button class="submit" onclick="transferSIM()">Transfer</button>
  <div id="transferResult" class="result"></div>
</div>

<!-- Agent Activation -->
<div id="activation" class="tab">
  <h2>Agent Activation Entry</h2>

  <input type="text" id="agentCode" placeholder="Agent Code">
  <input type="number" id="mobile" placeholder="Customer Mobile">

  <select id="operator">
    <option>JIO</option>
    <option>AIRTEL</option>
    <option>VI</option>
    <option>BSNL</option>
  </select>

  <select id="requestType">
    <option>New Activation</option>
    <option>MNP</option>
    <option>Replace</option>
  </select>

  <input type="number" id="amount" placeholder="Amount">

  <button class="submit" onclick="submitActivation()">Submit</button>
  <div id="activationResult" class="result"></div>
</div>

<script>

function openTab(tabName){
  var tabs=document.getElementsByClassName("tab");
  for(var i=0;i<tabs.length;i++){
    tabs[i].classList.remove("active");
  }
  document.getElementById(tabName).classList.add("active");
}

function addDistributorStock(){
  var qty=document.getElementById("distQty").value;
  google.script.run.withSuccessHandler(function(res){
    document.getElementById("stockResult").innerHTML=res;
  }).addDistributorStock(qty);
}

function transferSIM(){
  var lapu=document.getElementById("transferLapu").value;
  var qty=document.getElementById("transferQty").value;
  google.script.run.withSuccessHandler(function(res){
    document.getElementById("transferResult").innerHTML=res;
  }).transferSIM(lapu,qty);
}

function submitActivation(){

  var data={
    agentCode:document.getElementById("agentCode").value,
    mobile:document.getElementById("mobile").value,
    operator:document.getElementById("operator").value,
    requestType:document.getElementById("requestType").value,
    amount:document.getElementById("amount").value
  };

  google.script.run.withSuccessHandler(function(res){

    if(res.status=="duplicate"){
      document.getElementById("activationResult").innerHTML="Duplicate Entry ‚ùå";
    }
    else if(res.status=="no_stock"){
      document.getElementById("activationResult").innerHTML="No Stock ‚ùå";
    }
    else if(res.status=="success"){
      document.getElementById("activationResult").innerHTML="Success ‚úÖ Remaining: "+res.balance;
    }
    else{
      document.getElementById("activationResult").innerHTML="Invalid Data ‚ùå";
    }

  }).submitActivation(data);
}

</script>

</body>
</html>
